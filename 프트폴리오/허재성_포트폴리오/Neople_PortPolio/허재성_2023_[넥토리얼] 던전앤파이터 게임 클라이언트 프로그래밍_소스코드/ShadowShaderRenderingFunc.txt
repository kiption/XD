void GameObjectMgr::ShadowRender(ID3D12GraphicsCommandList* pd3dCommandList, CCamera* pCamera, bool bPrerender, ShaderMgr* pShader)
{
	if (m_pSkinnedAnimationController)
		m_pSkinnedAnimationController->UpdateShaderVariables(pd3dCommandList);

	OnPrepareRender();

	UpdateShaderVariable(pd3dCommandList, &m_xmf4x4World);
	if (m_pMesh) {
		if (m_nMaterials > 0) {
			for (int i = 0; i < m_nMaterials; i++) {

				if (m_ppMaterials[i]) {

					if (m_ppMaterials[i]->m_pShader) {

						m_ppMaterials[i]->m_pShader->Render(pd3dCommandList, pCamera, 0, false);
						pShader->SetPipelineState(pd3dCommandList, 0);
						UpdateShaderVariables(pd3dCommandList);
					}
					m_ppMaterials[i]->UpdateShaderVariable(pd3dCommandList);
					for (int k = 0; k < m_ppMaterials[i]->m_nTextures; k++) {

						if (m_ppMaterials[i]->m_ppTextures[k]) m_ppMaterials[i]->m_ppTextures[k]->UpdateShaderVariables(pd3dCommandList);
					}
				}
				m_pMesh->Render(pd3dCommandList, i);
			}
		}
	}
	if (m_pSibling) m_pSibling->ShadowRender(pd3dCommandList, pCamera, bPrerender, pShader);
	if (m_pChild) m_pChild->ShadowRender(pd3dCommandList, pCamera, bPrerender, pShader);
}